<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DVKE6J0Z2Z"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DVKE6J0Z2Z');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Write a School Review | FindSchool.uk Community</title>
    <meta name="description" content="Log in to FindSchool.uk to submit detailed school reviews that highlight leadership, teaching, wellbeing and enrichment opportunities." />
    <meta name="robots" content="noindex,follow" />
    <meta name="author" content="FindSchool.uk Community Team" />
    <meta name="keywords" content="write school review, FindSchool.uk account" />
    <link rel="canonical" href="https://www.findschool.uk/write-review" />
    <link rel="alternate" href="https://www.findschool.uk/write-review" hreflang="en-gb" />
    <meta name="referrer" content="strict-origin-when-cross-origin" />
    <meta name="theme-color" content="#2563eb" />
    <meta property="og:site_name" content="FindSchool.uk" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Write a School Review on FindSchool.uk" />
    <meta property="og:description" content="Share your UK school experiences securely with the FindSchool.uk community." />
    <meta property="og:url" content="https://www.findschool.uk/write-review" />
    <meta property="og:image" content="https://www.findschool.uk/images/findschool-social.png" />
    <meta property="og:image:alt" content="FindSchool.uk social preview card" />
    <meta property="og:locale" content="en_GB" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Write a School Review" />
    <meta name="twitter:description" content="Help UK families by adding your review to FindSchool.uk." />
    <meta name="twitter:image" content="https://www.findschool.uk/images/findschool-social.png" />
    <meta name="twitter:image:alt" content="FindSchool.uk social preview card" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "FindSchool.uk Review Writer",
        "url": "https://www.findschool.uk/write-review",
        "applicationCategory": "EducationApplication",
        "operatingSystem": "All"
      }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #ffffff;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .main-content {
            flex: 1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .page-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 2rem;
            font-weight: 400;
            color: #333;
            margin-bottom: 1rem;
        }

        .school-name {
            color: #007bff;
            font-weight: 500;
        }

        .change-school-btn {
            display: inline-block;
            margin-top: 0.5rem;
            padding: 0.5rem 1.5rem;
            background: white;
            border: 1px solid #007bff;
            color: #007bff;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .change-school-btn:hover {
            background: #007bff;
            color: white;
        }

        /* Two Column Layout */
        .review-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .form-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #333;
        }

        .required {
            color: #e74c3c;
            font-size: 0.875rem;
        }

        /* Star Rating */
        .star-rating {
            display: flex;
            gap: 0.25rem;
            margin: 1rem 0;
        }

        .star {
            font-size: 1.75rem;
            color: #ddd;
            cursor: pointer;
            transition: color 0.2s;
        }

        .star:hover,
        .star.filled {
            color: #ffc107;
        }

        /* Radio Buttons */
        .radio-group {
            display: flex;
            gap: 1.5rem;
            margin: 1rem 0;
        }

        .radio-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.95rem;
        }

        .radio-label input {
            margin-right: 0.5rem;
        }

        /* Scale Rating */
        .scale-container {
            margin: 1rem 0;
        }

        .scale-question {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 0.75rem;
            line-height: 1.4;
        }

        .scale-wrapper {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        .scale-label {
            font-size: 0.7rem;
            color: #888;
            text-transform: uppercase;
        }

        .scale-dots {
            display: flex;
            gap: 0.75rem;
            flex: 1;
            justify-content: center;
            margin: 0 1rem;
        }

        .scale-dot {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid #ddd;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .scale-dot:hover {
            border-color: #007bff;
            transform: scale(1.1);
        }

        .scale-dot.selected {
            background: #007bff;
            border-color: #007bff;
        }

        /* Textarea */
        .review-textarea {
            width: 100%;
            min-height: 150px;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
            font-size: 0.95rem;
            resize: vertical;
        }

        .review-textarea:focus {
            outline: none;
            border-color: #007bff;
        }

        .char-counter {
            text-align: right;
            font-size: 0.75rem;
            color: #777;
            margin-top: 0.25rem;
        }

        .char-counter.error {
            color: #e74c3c;
        }

        /* Select Dropdown */
        .select-dropdown {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.95rem;
            background: white;
            cursor: pointer;
        }

        .select-dropdown:focus {
            outline: none;
            border-color: #007bff;
        }

        /* Submit Section */
        .submit-section {
            grid-column: span 2;
            text-align: center;
            padding: 2rem 0;
            border-top: 1px solid #e5e7eb;
            margin-top: 2rem;
        }

        .submit-btn {
            background: #007bff;
            color: white;
            padding: 0.875rem 2.5rem;
            border: none;
            border-radius: 4px;
            font-size: 1.125rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }

        .submit-btn:hover {
            background: #0056b3;
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Terms */
        .terms-text {
            font-size: 0.75rem;
            color: #777;
            margin-bottom: 1rem;
        }

        .terms-text a {
            color: #007bff;
            text-decoration: none;
        }

        .guidelines-link {
            color: #007bff;
            text-decoration: none;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            margin-top: 0.5rem;
        }

        /* Full width cards */
        .full-width {
            grid-column: span 2;
        }

        @media (max-width: 768px) {
            .review-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .submit-section,
            .full-width {
                grid-column: span 1;
            }
        }
    </style>
</head>
<body>
    <div id="header"></div>

    <main class="main-content">
        <div class="container">
            <div class="page-header">
                <h1>Write a review of <span class="school-name" id="schoolNameDisplay">a school</span></h1>
                <a href="/review" class="change-school-btn" id="changeSchoolBtn">Search for a different school</a>
            </div>

            <form id="reviewForm">
                <!-- Overall Experience and Recommendation (Full Width) -->
                <div class="form-card full-width">
                    <div class="form-title">Overall experience <span class="required">(required)</span></div>
                    <div class="star-rating" id="overallRating">
                        <span class="star" data-value="1">☆</span>
                        <span class="star" data-value="2">☆</span>
                        <span class="star" data-value="3">☆</span>
                        <span class="star" data-value="4">☆</span>
                        <span class="star" data-value="5">☆</span>
                    </div>

                    <div style="margin-top: 1.5rem;">
                        <div style="font-weight: 500; margin-bottom: 0.5rem;">Would you recommend this school?</div>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="recommend" value="yes" required>
                                <span>Yes</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="recommend" value="no" required>
                                <span>No</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="review-grid">
                    <!-- Left Column -->
                    <div>
                        <!-- Learning -->
                        <div class="form-card">
                            <div class="form-title">Learning</div>
                            <div class="scale-question">In my experience, students at this school feel excited about what they're learning</div>
                            <div class="scale-wrapper">
                                <span class="scale-label">DISAGREE</span>
                                <div class="scale-dots" data-category="learning">
                                    <span class="scale-dot" data-value="1"></span>
                                    <span class="scale-dot" data-value="2"></span>
                                    <span class="scale-dot" data-value="3"></span>
                                    <span class="scale-dot" data-value="4"></span>
                                    <span class="scale-dot" data-value="5"></span>
                                </div>
                                <span class="scale-label">AGREE</span>
                            </div>
                        </div>

                        <!-- Teaching -->
                        <div class="form-card">
                            <div class="form-title">Teaching</div>
                            <div class="scale-question">In my experience, teachers at this school are respectful, supportive, and motivate their students to learn</div>
                            <div class="scale-wrapper">
                                <span class="scale-label">DISAGREE</span>
                                <div class="scale-dots" data-category="teaching">
                                    <span class="scale-dot" data-value="1"></span>
                                    <span class="scale-dot" data-value="2"></span>
                                    <span class="scale-dot" data-value="3"></span>
                                    <span class="scale-dot" data-value="4"></span>
                                    <span class="scale-dot" data-value="5"></span>
                                </div>
                                <span class="scale-label">AGREE</span>
                            </div>
                        </div>

                        <!-- Social-emotional support -->
                        <div class="form-card">
                            <div class="form-title">Social-emotional support</div>
                            <div class="scale-question">In my experience, this school supports students' mental health and emotional well-being</div>
                            <div class="scale-wrapper">
                                <span class="scale-label">DISAGREE</span>
                                <div class="scale-dots" data-category="social_emotional">
                                    <span class="scale-dot" data-value="1"></span>
                                    <span class="scale-dot" data-value="2"></span>
                                    <span class="scale-dot" data-value="3"></span>
                                    <span class="scale-dot" data-value="4"></span>
                                    <span class="scale-dot" data-value="5"></span>
                                </div>
                                <span class="scale-label">AGREE</span>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div>
                        <!-- Special Education -->
                        <div class="form-card">
                            <div class="form-title">Special Education</div>
                            <div class="scale-question">This school provides students with disabilities the support and accommodations they require</div>
                            <div class="scale-wrapper">
                                <span class="scale-label">DISAGREE</span>
                                <div class="scale-dots" data-category="special_education">
                                    <span class="scale-dot" data-value="1"></span>
                                    <span class="scale-dot" data-value="2"></span>
                                    <span class="scale-dot" data-value="3"></span>
                                    <span class="scale-dot" data-value="4"></span>
                                    <span class="scale-dot" data-value="5"></span>
                                </div>
                                <span class="scale-label">AGREE</span>
                            </div>
                        </div>

                        <!-- Safety -->
                        <div class="form-card">
                            <div class="form-title">Safety</div>
                            <div class="scale-question">In my experience, this school provides an environment safe from violence, discrimination, and harsh punishment</div>
                            <div class="scale-wrapper">
                                <span class="scale-label">DISAGREE</span>
                                <div class="scale-dots" data-category="safety">
                                    <span class="scale-dot" data-value="1"></span>
                                    <span class="scale-dot" data-value="2"></span>
                                    <span class="scale-dot" data-value="3"></span>
                                    <span class="scale-dot" data-value="4"></span>
                                    <span class="scale-dot" data-value="5"></span>
                                </div>
                                <span class="scale-label">AGREE</span>
                            </div>
                        </div>

                        <!-- Family Engagement -->
                        <div class="form-card">
                            <div class="form-title">Family Engagement</div>
                            <div class="scale-question">In my experience, the school welcomes and includes families as partners in their children's learning</div>
                            <div class="scale-wrapper">
                                <span class="scale-label">DISAGREE</span>
                                <div class="scale-dots" data-category="family_engagement">
                                    <span class="scale-dot" data-value="1"></span>
                                    <span class="scale-dot" data-value="2"></span>
                                    <span class="scale-dot" data-value="3"></span>
                                    <span class="scale-dot" data-value="4"></span>
                                    <span class="scale-dot" data-value="5"></span>
                                </div>
                                <span class="scale-label">AGREE</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Written Review (Full Width) -->
                <div class="form-card full-width">
                    <div class="form-title">Write your review <span class="required">(required)</span></div>
                    <textarea class="review-textarea" id="reviewText" 
                        placeholder="Example: What is your experience like at this school? How would you describe the community? What is it like in the classroom? Please explain."
                        required minlength="50" maxlength="2500"></textarea>
                    <div class="char-counter" id="charCounter">0 / 2500</div>
                    
                    <a href="#" class="guidelines-link">
                        ℹ️ Editors check your review using these guidelines.
                    </a>
                </div>

                <!-- Your Relationship (Full Width) -->
                <div class="form-card full-width">
                    <div class="form-title">Your relationship with this school:</div>
                    <select class="select-dropdown" id="relationship" required>
                        <option value="" disabled selected>I am a...</option>
                        <option value="parent_guardian">Parent/guardian</option>
                        <option value="teacher">Teacher</option>
                        <option value="current_student">Current student</option>
                        <option value="school_leader">School leader</option>
                        <option value="other_staff">Other (school staff, family member, recent alum, etc.)</option>
                    </select>
                </div>

                <!-- Submit Section -->
                <div class="submit-section">
                    <p class="terms-text">
                        Authentication only - we never sell personal information. By submitting a review, you agree to FindSchool.uk's 
                        <a href="/terms">Terms of Use</a> and <a href="/privacy">Privacy Policy</a>.
                    </p>
                    <button type="submit" class="submit-btn">Submit your review</button>
                </div>
            </form>
        </div>
        <div id="footer"></div>
    </main>

    

    <script src="/js/main.js"></script>
    <script>
        let selectedSchool = null;
        let overallRating = 0;
        let categoryRatings = {};

        // Get school info from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const schoolUrn = urlParams.get('urn');
        const schoolName = urlParams.get('name');
        const schoolTown = urlParams.get('town');

        // Set school name if provided
        if (schoolUrn && schoolName) {
            selectedSchool = { urn: schoolUrn, name: decodeURIComponent(schoolName), town: decodeURIComponent(schoolTown || '') };
            document.getElementById('schoolNameDisplay').textContent = selectedSchool.name;
        } else {
            // Redirect to review search page if no school selected
            window.location.href = '/review';
        }

        // Star rating functionality
        const stars = document.querySelectorAll('#overallRating .star');
        stars.forEach(star => {
            star.addEventListener('click', function() {
                overallRating = parseInt(this.dataset.value);
                updateStars();
            });
            
            star.addEventListener('mouseenter', function() {
                const hoverRating = parseInt(this.dataset.value);
                updateStarsPreview(hoverRating);
            });
        });

        document.getElementById('overallRating').addEventListener('mouseleave', updateStars);

        function updateStars() {
            stars.forEach((star, index) => {
                star.textContent = index < overallRating ? '★' : '☆';
                star.classList.toggle('filled', index < overallRating);
            });
        }

        function updateStarsPreview(rating) {
            stars.forEach((star, index) => {
                star.textContent = index < rating ? '★' : '☆';
            });
        }

        // Scale rating functionality
        document.querySelectorAll('.scale-dots').forEach(container => {
            const category = container.dataset.category;
            const dots = container.querySelectorAll('.scale-dot');
            
            dots.forEach(dot => {
                dot.addEventListener('click', function() {
                    const value = parseInt(this.dataset.value);
                    categoryRatings[category] = value;
                    updateScale(container, value);
                });
            });
        });

        function updateScale(container, value) {
            const dots = container.querySelectorAll('.scale-dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('selected', index < value);
            });
        }

        // Character counter
        const reviewText = document.getElementById('reviewText');
        const charCounter = document.getElementById('charCounter');
        
        reviewText.addEventListener('input', function() {
            const length = this.value.length;
            charCounter.textContent = `${length} / 2500`;
            charCounter.classList.toggle('error', length < 50);
        });

        // Form submission
        document.getElementById('reviewForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!selectedSchool) {
                alert('Please select a school');
                window.location.href = '/review';
                return;
            }
            
            if (!overallRating) {
                alert('Please provide an overall rating');
                return;
            }
            
            if (reviewText.value.length < 50) {
                alert('Your review must be at least 50 characters');
                return;
            }
            
            const recommend = document.querySelector('input[name="recommend"]:checked');
            if (!recommend) {
                alert('Please indicate if you would recommend this school');
                return;
            }
            
            const relationship = document.getElementById('relationship').value;
            if (!relationship) {
                alert('Please select your relationship to the school');
                return;
            }
            
            const reviewData = {
                overall_rating: overallRating,
                learning_rating: categoryRatings.learning || null,
                teaching_rating: categoryRatings.teaching || null,
                social_emotional_rating: categoryRatings.social_emotional || null,
                special_education_rating: categoryRatings.special_education || null,
                safety_rating: categoryRatings.safety || null,
                family_engagement_rating: categoryRatings.family_engagement || null,
                would_recommend: recommend.value === 'yes',
                review_text: reviewText.value,
                reviewer_type: relationship
            };
            
            try {
                const response = await fetch(`/api/schools/${selectedSchool.urn}/reviews`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(reviewData)
                });
                
                if (response.ok) {
                    alert('Thank you for your review!');
                    const target = window.schoolPath ? window.schoolPath(selectedSchool) : `/school/${selectedSchool.urn}`;
                    window.location.href = target;
                } else {
                    const error = await response.json();
                    alert(error.error || 'Failed to submit review');
                }
            } catch (error) {
                console.error('Submit error:', error);
                alert('Failed to submit review. Please try again.');
            }
        });
    </script>
</body>
</html>
